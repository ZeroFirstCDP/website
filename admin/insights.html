import React, { useState, useRef, useEffect } from 'react';
import { Layers3, Database, ArrowRightLeft, User, BookLock, Settings, LogOut, Search, ChevronDown, ChevronUp, Users, PieChart, Map, Sparkles, Users2, Share2, X } from 'lucide-react';
import { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid } from 'recharts';

// NOTE: The interactive map functionality was replaced with a static image 
// to resolve build errors in this prototyping environment. The required map 
// libraries (react-leaflet, leaflet) could not be resolved.

// Reusable component for sidebar navigation items
const NavItem = ({ icon, label, active = false }) => {
  const Icon = icon;
  return (
    <a
      href="#"
      className={`flex items-center px-4 py-2.5 text-sm font-medium rounded-md transition-colors ${
        active
          ? 'bg-purple-50 text-purple-700'
          : 'text-gray-700 hover:bg-gray-100'
      }`}
    >
      <Icon className="w-5 h-5 mr-3" />
      {label}
    </a>
  );
};

// Mock data for the charts
const traitData = {
    gender: [
        { name: 'Female', value: 9800 },
        { name: 'Male', value: 11200 },
        { name: 'Other', value: 1400 },
    ],
    age: [
        { name: '18-24', value: 6500 },
        { name: '25-34', value: 8200 },
        { name: '35-44', value: 4300 },
        { name: '45+', value: 3400 },
    ],
    device_type: [
        { name: 'Mobile', value: 15400 },
        { name: 'Desktop', value: 6200 },
        { name: 'Tablet', value: 800 },
    ],
};

const InsightsTab = () => {
    const [selectedTrait, setSelectedTrait] = useState('gender');
    const [generatedSummary, setGeneratedSummary] = useState('');
    const [isLoadingSummary, setIsLoadingSummary] = useState(false);
    const [audienceSuggestions, setAudienceSuggestions] = useState([]);
    const [isLoadingSuggestions, setIsLoadingSuggestions] = useState(false);
    const totalUsers = 22400;
    
    const [isDropdownOpen, setIsDropdownOpen] = useState(false);
    const [searchTerm, setSearchTerm] = useState('');
    const dropdownRef = useRef(null);

    const allTraits = [
        { value: 'gender', label: 'Gender' },
        { value: 'age', label: 'Age' },
        { value: 'device_type', label: 'Device Type' },
    ];

    const filteredTraits = allTraits.filter(trait =>
        trait.label.toLowerCase().includes(searchTerm.toLowerCase())
    );

    useEffect(() => {
        const handleClickOutside = (event) => {
            if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {
                setIsDropdownOpen(false);
            }
        };
        document.addEventListener("mousedown", handleClickOutside);
        return () => {
            document.removeEventListener("mousedown", handleClickOutside);
        };
    }, []);


    const generateInsights = async () => {
        setIsLoadingSummary(true);
        setGeneratedSummary('');

        const systemPrompt = `You are a marketing analyst. Your task is to provide a concise, insightful summary based on the provided audience data. Analyze the demographics and traits to highlight the key characteristics of this user group. The summary should be a single paragraph.`;
        
        const userQuery = `
            Here is the data for an audience with a total of ${totalUsers.toLocaleString()} users.
            
            Users by Gender: ${JSON.stringify(traitData.gender)}
            Users by Age Group: ${JSON.stringify(traitData.age)}
            Users by Device Type: ${JSON.stringify(traitData.device_type)}

            Please provide a summary of this audience's key characteristics.
        `;

        const apiKey = ""; // API key will be provided by the environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        
        const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
            systemInstruction: {
                parts: [{ text: systemPrompt }]
            },
        };

        try {
            let response;
            let retries = 3;
            let delay = 1000;
            while (retries > 0) {
                response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.ok) break;
                
                retries--;
                if(retries > 0) {
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2;
                }
            }
            
            if (!response.ok) {
                throw new Error(`API call failed with status: ${response.status}`);
            }

            const result = await response.json();
            const candidate = result.candidates?.[0];

            if (candidate && candidate.content?.parts?.[0]?.text) {
                setGeneratedSummary(candidate.content.parts[0].text);
            } else {
                setGeneratedSummary("Could not generate a summary. The model's response was empty.");
            }
        } catch (error) {
            console.error("Error generating insights:", error);
            setGeneratedSummary("An error occurred while generating the summary. Please try again.");
        } finally {
            setIsLoadingSummary(false);
        }
    };

    const generateAudienceSuggestions = async () => {
        setIsLoadingSuggestions(true);
        setAudienceSuggestions([]);

        const systemPrompt = "You are an expert marketing strategist specializing in audience segmentation. Based on an existing audience, your task is to suggest three new, distinct audience segments that are similar but target different niches. Provide a name, a brief description, and the key criteria for each suggestion in a structured JSON format.";
        
        const userQuery = `The current audience is defined by these criteria: 'Users that has email containing @' and 'And that performed Channel Played at least 1 time'. The audience is primarily composed of males (50%), aged 25-34 (37%), and uses mobile devices (69%). Please suggest three similar audience segments to explore.`;

        const apiKey = ""; // API key will be provided by the environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
            systemInstruction: { parts: [{ text: systemPrompt }] },
            generationConfig: {
                responseMimeType: "application/json",
                responseSchema: {
                    type: "ARRAY",
                    items: {
                        type: "OBJECT",
                        properties: {
                            name: { type: "STRING" },
                            description: { type: "STRING" },
                            criteria: {
                                type: "ARRAY",
                                items: { type: "STRING" }
                            }
                        },
                        required: ["name", "description", "criteria"]
                    }
                }
            }
        };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                throw new Error(`API call failed with status: ${response.status}`);
            }

            const result = await response.json();
            const candidate = result.candidates?.[0];
            
            if (candidate && candidate.content?.parts?.[0]?.text) {
                const suggestions = JSON.parse(candidate.content.parts[0].text);
                setAudienceSuggestions(suggestions);
            } else {
                 setAudienceSuggestions([]);
                 console.error("Could not generate suggestions. The model's response was empty or invalid.");
            }
        } catch (error) {
            console.error("Error generating audience suggestions:", error);
        } finally {
            setIsLoadingSuggestions(false);
        }
    };


    return (
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
            {/* How many users */}
            <div className="lg:col-span-1 bg-white p-6 rounded-lg border border-gray-200 flex flex-col items-center justify-center">
                <Users className="w-12 h-12 text-purple-600 mb-4" />
                <p className="text-4xl font-bold text-gray-800">
                    {totalUsers.toLocaleString()}
                </p>
                <p className="text-sm text-gray-500 mt-1">Total Users in Audience</p>
            </div>

            {/* Users per traits */}
            <div className="lg:col-span-2 bg-white p-6 rounded-lg border border-gray-200">
                <div className="flex justify-between items-center mb-4">
                    <div className="flex items-center">
                        <PieChart className="w-6 h-6 text-purple-600 mr-2" />
                        <h3 className="text-lg font-semibold text-gray-800">Users per Trait</h3>
                    </div>
                    <div className="relative" ref={dropdownRef}>
                        <button
                            onClick={() => setIsDropdownOpen(!isDropdownOpen)}
                            className="flex items-center justify-between w-48 border border-gray-300 rounded-md px-3 py-1.5 text-sm focus:ring-2 focus:ring-purple-500 focus:outline-none bg-white"
                        >
                            <span>{allTraits.find(t => t.value === selectedTrait)?.label}</span>
                            <ChevronDown className={`w-4 h-4 text-gray-500 transition-transform ${isDropdownOpen ? 'transform rotate-180' : ''}`} />
                        </button>
                        {isDropdownOpen && (
                            <div className="absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10">
                                <div className="p-2">
                                    <div className="relative">
                                        <Search className="absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
                                        <input
                                            type="text"
                                            placeholder="Search traits"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="w-full border border-gray-300 rounded-md pl-8 pr-2 py-1.5 text-sm focus:ring-1 focus:ring-purple-500 focus:outline-none"
                                        />
                                    </div>
                                </div>
                                <ul className="max-h-60 overflow-auto">
                                    {filteredTraits.length > 0 ? filteredTraits.map(trait => (
                                        <li key={trait.value}>
                                            <a
                                                href="#"
                                                onClick={(e) => {
                                                    e.preventDefault();
                                                    setSelectedTrait(trait.value);
                                                    setIsDropdownOpen(false);
                                                    setSearchTerm('');
                                                }}
                                                className="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700"
                                            >
                                                {trait.label}
                                            </a>
                                        </li>
                                    )) : (
                                        <li className="px-4 py-2 text-sm text-gray-500">No results found</li>
                                    )}
                                </ul>
                            </div>
                        )}
                    </div>
                </div>
                <div style={{ width: '100%', height: 240 }}>
                    <ResponsiveContainer>
                        <BarChart data={traitData[selectedTrait]} margin={{ top: 5, right: 20, left: -10, bottom: 5 }}>
                            <CartesianGrid strokeDasharray="3 3" vertical={false} />
                            <XAxis dataKey="name" tick={{ fontSize: 12 }} />
                            <YAxis tick={{ fontSize: 12 }} />
                            <Tooltip cursor={{ fill: 'rgba(233, 213, 255, 0.5)' }} />
                            <Bar dataKey="value" fill="#8B5CF6" radius={[4, 4, 0, 0]} />
                        </BarChart>
                    </ResponsiveContainer>
                </div>
            </div>
            
            {/* Audience heatmap */}
            <div className="lg:col-span-3 bg-white p-6 rounded-lg border border-gray-200">
                 <div className="flex items-center mb-4">
                    <Map className="w-6 h-6 text-purple-600 mr-2" />
                    <h3 className="text-lg font-semibold text-gray-800">Audience Heatmap</h3>
                </div>
                <div className="rounded-lg overflow-hidden border border-gray-200">
                   <img 
                     src="https://i.imgur.com/3YdE57y.jpeg" 
                     alt="Audience heatmap" 
                     className="w-full h-full object-cover"
                   />
                </div>
            </div>

            {/* AI-Powered Summary */}
            <div className="lg:col-span-3 bg-white p-6 rounded-lg border border-gray-200">
                <div className="flex justify-between items-center mb-4">
                    <div className="flex items-center">
                        <Sparkles className="w-6 h-6 text-purple-600 mr-2" />
                        <h3 className="text-lg font-semibold text-gray-800">AI-Powered Summary</h3>
                    </div>
                    <button
                        onClick={generateInsights}
                        disabled={isLoadingSummary}
                        className="px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
                    >
                        {isLoadingSummary ? 'Generating...' : 'Generate Summary'}
                    </button>
                </div>
                <div className="bg-gray-50 p-4 rounded-md min-h-[100px] text-sm text-gray-700 border border-gray-200">
                    {isLoadingSummary ? (
                        <div className="flex items-center justify-center h-full">
                            <p className="text-gray-500">Analyzing data...</p>
                        </div>
                    ) : generatedSummary ? (
                        <p className="whitespace-pre-wrap">{generatedSummary}</p>
                    ) : (
                        <p className="text-gray-400">Click "Generate Summary" to get an AI-powered analysis of this audience.</p>
                    )}
                </div>
            </div>

             {/* Audience Expansion Suggestions */}
            <div className="lg:col-span-3 bg-white p-6 rounded-lg border border-gray-200">
                <div className="flex justify-between items-center mb-4">
                    <div className="flex items-center">
                        <Users2 className="w-6 h-6 text-purple-600 mr-2" />
                        <h3 className="text-lg font-semibold text-gray-800">Audience Expansion Suggestions</h3>
                    </div>
                    <button
                        onClick={generateAudienceSuggestions}
                        disabled={isLoadingSuggestions}
                        className="px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
                    >
                        {isLoadingSuggestions ? 'Suggesting...' : 'Get Suggestions'}
                    </button>
                </div>
                <div className="min-h-[150px]">
                    {isLoadingSuggestions ? (
                        <div className="flex items-center justify-center h-full">
                            <p className="text-gray-500">Generating new audience ideas...</p>
                        </div>
                    ) : audienceSuggestions.length > 0 ? (
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            {audienceSuggestions.map((suggestion, index) => (
                                <div key={index} className="bg-gray-50 p-4 rounded-lg border border-gray-200 flex flex-col justify-between">
                                    <div>
                                        <h4 className="font-bold text-gray-800">{suggestion.name}</h4>
                                        <p className="text-xs text-gray-600 mt-1 mb-3">{suggestion.description}</p>
                                        <ul className="space-y-1">
                                            {suggestion.criteria.map((item, i) => (
                                                <li key={i} className="text-xs inline-flex items-center bg-purple-100 text-purple-800 px-2.5 py-1 rounded-full mr-1 mb-1">{item}</li>
                                            ))}
                                        </ul>
                                    </div>
                                    <div className="mt-4">
                                        <button className="w-full px-4 py-2 text-sm font-medium text-purple-700 bg-white border border-purple-300 rounded-md shadow-sm hover:bg-purple-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors">
                                            Create new Audience
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="flex items-center justify-center h-full bg-gray-50 rounded-md border border-gray-200">
                             <p className="text-gray-400 text-sm">Click "Get Suggestions" to discover new potential audiences.</p>
                        </div>
                    )}
                </div>
            </div>
        </div>
    );
};


// Main App Component
export default function App() {
  const [activeTab, setActiveTab] = useState('Overview');
  const [shareLink, setShareLink] = useState('');
  const [showShareNotification, setShowShareNotification] = useState(false);
  const [isCopied, setIsCopied] = useState(false);

  const users = [
    { name: 'Audience name', email: 'test@test.com', firstActivity: '12/12/2024', lastActivity: '12/12/2024' },
    { name: 'Audience name', email: 'test@test.com', firstActivity: '12/12/2024', lastActivity: '12/12/2024' },
    { name: 'Audience name', email: 'test@test.com', firstActivity: '12/12/2024', lastActivity: '12/12/2024' },
  ];

  const handleShareInsights = () => {
    // Generate a pseudo-temporary link for the prototype
    const link = `${window.location.origin}${window.location.pathname}?view=insights&shared=true&expires=${Date.now() + 86400000}`; // Link expires in 24 hours
    setShareLink(link);
    setShowShareNotification(true);
    setIsCopied(false); 
    setTimeout(() => {
        setShowShareNotification(false);
    }, 10000); // Hide notification after 10 seconds
  };

  const copyToClipboard = () => {
    const textField = document.createElement('textarea');
    textField.innerText = shareLink;
    document.body.appendChild(textField);
    textField.select();
    document.execCommand('copy');
    textField.remove();
    setIsCopied(true);
    setTimeout(() => setIsCopied(false), 2000); // Reset copied message after 2s
  };

  return (
    <div className="flex h-screen bg-gray-50 font-sans relative">
       {/* Share Link Notification */}
       {showShareNotification && (
        <div className="absolute top-5 right-5 w-full max-w-sm bg-white rounded-lg shadow-2xl p-4 z-50 border border-gray-200">
            <div className="flex justify-between items-start">
                <div>
                    <h4 className="font-semibold text-gray-800">Shareable Link Created</h4>
                    <p className="text-sm text-gray-500 mt-1">Anyone with this link can view the insights. Link is valid for 24 hours.</p>
                </div>
                <button onClick={() => setShowShareNotification(false)} className="text-gray-400 hover:text-gray-600 p-1 rounded-full -mt-1 -mr-1">
                    <X className="w-5 h-5"/>
                </button>
            </div>
            <div className="mt-4 flex items-center bg-gray-100 border border-gray-200 rounded-md p-2">
                <input 
                    type="text" 
                    readOnly 
                    value={shareLink} 
                    className="flex-1 bg-transparent text-sm text-gray-700 outline-none select-all"
                />
                <button 
                    onClick={copyToClipboard} 
                    className="ml-2 px-3 py-1 text-sm font-medium text-purple-700 bg-purple-100 rounded-md hover:bg-purple-200 focus:outline-none transition-colors w-20"
                >
                    {isCopied ? 'Copied!' : 'Copy'}
                </button>
            </div>
        </div>
      )}

      {/* Sidebar */}
      <aside className="w-64 bg-white border-r border-gray-200 flex flex-col">
        <div className="p-6 flex items-center space-x-2">
           <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="16" fill="black"/>
            <path d="M16 4C9.37258 4 4 9.37258 4 16C4 22.6274 9.37258 28 16 28C22.6274 28 28 22.6274 28 16C28 9.37258 22.6274 4 16 4ZM16 26C10.4772 26 6 21.5228 6 16C6 10.4772 10.4772 6 16 6C21.5228 6 26 10.4772 26 16C26 21.5228 21.5228 26 16 26Z" fill="white"/>
            </svg>
          <span className="text-xl font-bold tracking-tighter">zero first</span>
        </div>
        <nav className="flex-1 px-4 space-y-1">
          <NavItem icon={Layers3} label="Audience" active />
          <NavItem icon={Database} label="Sources" />
          <NavItem icon={ArrowRightLeft} label="Destinations" />
          <NavItem icon={User} label="Profiles" />
          <NavItem icon={BookLock} label="Protocols" />
          <div className="flex items-center justify-between text-gray-700 hover:bg-gray-100 px-4 py-2.5 rounded-md cursor-pointer">
              <div className="flex items-center">
                  <Settings className="w-5 h-5 mr-3" />
                  <span className="text-sm font-medium">Settings</span>
              </div>
              <ChevronDown className="w-4 h-4" />
          </div>
        </nav>
        <div className="p-4 border-t border-gray-200">
          <div className="flex items-center justify-between">
            <div className="flex items-center">
              <div className="w-8 h-8 rounded-full bg-gray-300 mr-3"></div>
              <span className="text-sm font-medium">Username</span>
            </div>
            <LogOut className="w-5 h-5 text-gray-500 cursor-pointer hover:text-gray-800" />
          </div>
        </div>
      </aside>

      {/* Main Content */}
      <main className="flex-1 overflow-y-auto">
        {/* Header with Background Image */}
        <div
          className="h-48 bg-cover bg-center text-white p-8 flex flex-col justify-end"
          style={{ backgroundImage: "url('https://i.imgur.com/GNXRF1K.jpeg')" }}
        >
          <p className="text-sm text-gray-300">Audiences &gt; Audience details</p>
          <h2 className="text-4xl font-bold mt-1">Audience details</h2>
        </div>

        {/* Content Body */}
        <div className="p-8">
          {/* Name & Actions */}
          <div className="flex justify-between items-center">
            <div>
              <h3 className="text-lg font-semibold text-gray-900">Name</h3>
              <p className="text-gray-500 mt-1">Description</p>
            </div>
            <div className="flex items-center space-x-6 text-sm">
               <button onClick={handleShareInsights} className="flex items-center px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors">
                <Share2 className="w-4 h-4 mr-2" />
                Share Insights
              </button>
              <a href="#" className="font-medium text-purple-600 hover:text-purple-800">Duplicate</a>
              <a href="#" className="font-medium text-purple-600 hover:text-purple-800">Remove</a>
              <a href="#" className="font-medium text-purple-600 hover:text-purple-800">Edit</a>
            </div>
          </div>

          {/* Tabs */}
            <div className="mt-6 border-b border-gray-200">
                <div className="flex space-x-4">
                    <button
                        onClick={() => setActiveTab('Overview')}
                        className={`px-1 py-2 text-sm font-medium border-b-2 ${
                            activeTab === 'Overview' ? 'border-purple-600 text-purple-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                        }`}
                    >
                        Overview
                    </button>
                    <button
                        onClick={() => setActiveTab('Insights')}
                        className={`px-1 py-2 text-sm font-medium border-b-2 ${
                            activeTab === 'Insights' ? 'border-purple-600 text-purple-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                        }`}
                    >
                        Insights
                    </button>
                </div>
            </div>


            {/* Tab Content */}
            <div className="mt-6">
                {activeTab === 'Overview' && (
                <>
                    {/* Criteria Box */}
                    <div className="border border-gray-200 rounded-lg bg-white">
                        <div className="flex justify-between items-center p-4">
                        <h4 className="font-semibold text-gray-900">Criteria</h4>
                        <ChevronUp className="w-5 h-5 text-gray-500 cursor-pointer" />
                        </div>
                        <div className="p-6 border-t border-gray-200 bg-gray-50 rounded-b-lg">
                        <div className="flex items-center space-x-2">
                            <div className="bg-white border border-gray-300 rounded-full px-4 py-1.5 text-sm shadow-sm">
                            Users that has <span className="font-semibold">email</span> containing <span className="font-semibold">@</span>
                            </div>
                            <div className="bg-white border border-gray-300 rounded-full px-4 py-1.5 text-sm shadow-sm">
                            And that performed <span className="font-semibold">Channel Played</span> at least <span className="font-semibold">1 time</span>
                            </div>
                        </div>
                        </div>
                    </div>

                    {/* Users List */}
                    <div className="mt-8">
                        <div className="flex justify-between items-center mb-4">
                        <h4 className="text-lg font-semibold text-gray-900">Users</h4>
                        <span className="text-sm text-gray-500">Audience size: 22.4k</span>
                        </div>
                        <div className="relative">
                        <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
                        <input
                            type="text"
                            placeholder="Search user by name"
                            className="w-full max-w-xs border border-gray-300 rounded-md pl-10 pr-4 py-2 text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500 focus:outline-none"
                        />
                        </div>
                    </div>

                    {/* Users Table */}
                    <div className="mt-4 overflow-x-auto">
                        <div className="border border-gray-200 rounded-lg">
                            <table className="min-w-full bg-white">
                            <thead className="bg-purple-50">
                                <tr>
                                <th className="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Name</th>
                                <th className="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Email</th>
                                <th className="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">First activity date</th>
                                <th className="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">Last activity date</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200">
                                {users.map((user, index) => (
                                <tr key={index} className="hover:bg-gray-50">
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{user.name}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{user.email}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{user.firstActivity}</td>
                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-800">{user.lastActivity}</td>
                                </tr>
                                ))}
                            </tbody>
                            </table>
                        </div>
                    </div>
                </>
                )}
                {activeTab === 'Insights' && (
                   <InsightsTab />
                )}
            </div>
        </div>
      </main>
    </div>
  );
}


